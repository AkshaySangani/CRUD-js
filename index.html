<html>
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body>
<div class="container my-5">
    name<input id="fname" type="text">
    lname<input id="lname" type="text">
    <button type="button" class="btn-primary " onclick="submit()">submit</button>

    <table class="table">
        <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">First</th>
            <th scope="col">Last</th>
            <th scope="col">Handle</th>
        </tr>
        </thead>
        <tbody id="tbody">

        </tbody>
    </table>
</div>
<script>
    // tablefill()
    var index = '';
    var ffname = document.getElementById("fname");
    var llname = document.getElementById("lname");
    var arr = [];

    function fillobj() {
        let x = {};
        x['fname'] = ffname.value;
        x['lname'] = llname.value;
        return x;
    }

    function submit() {
        if (index === '') {
            var obj = fillobj();
            arr.push(obj);
            var crud = JSON.parse(localStorage.getItem("crud"))
            if (crud == undefined) {
                localStorage.setItem("crud", JSON.stringify(arr));
            } else {
                crud.push(obj);
                localStorage.setItem("crud", JSON.stringify(crud));
            }
            document.getElementById("tbody").innerHTML = ''
            tablefill()
            // document .getElementById("tbody")
        } else {
            update(index);
        }
    }

    function update(i){
        var obj2=fillobj()
        let crud = JSON.parse(localStorage.getItem("crud"));
        crud[i]=obj2;
        localStorage.setItem("crud", JSON.stringify(crud));
        document.getElementById("tbody").innerHTML = ''
        tablefill();
    }

    // function update(i) {
    //     // let crud = JSON.parse(localStorage.getItem("crud"));
    //     arr[i].ffname=document.getElementById('fname').value
    //     arr[i].llname=document.getElementById('lname').value
    //     localStorage.setItem("crud", JSON.stringify(arr));
    //     tablefill()
    // }

    tablefill()

    function tablefill() {
        var data = JSON.parse(localStorage.getItem("crud"));
        data.forEach((element, i) => {

            let row = document.getElementById("tbody")

            let rows = document.createElement("tr");
            let td1 = document.createElement('td');
            td1.innerText = i;
            row.appendChild(td1);
            let td2 = document.createElement('td');
            td2.innerText = element.fname;
            row.appendChild(td2);
            let td3 = document.createElement('td');
            td3.innerText = element.lname;
            row.appendChild(td3);
            let td4 = document.createElement('button')
            td4.innerHTML = "edit";
            td4.addEventListener("click", () => {
                edit(i);
                console.log("iiii", i)
            })
            row.appendChild(td4)
            let td5 = document.createElement('button')
            td5.innerHTML = "delete";
            td5.addEventListener("click", () => {
                deletes(i);
                console.log("iiii", i)
            })
            row.appendChild(td5)
            row.appendChild(rows)
        })
    }

    function edit(i) {
        index = i;
        var crud = JSON.parse(localStorage.getItem("crud"));
        let editabledata = crud[i];
        console.log(editabledata);
        ffname.value = editabledata.fname;
        llname.value = editabledata.lname;
    }

    function deletes(i) {
        var crud = JSON.parse(localStorage.getItem("crud"));
        crud.splice(i, 1);
        localStorage.setItem("crud", JSON.stringify(crud));
        document.getElementById("tbody").innerHTML = ''
        tablefill()
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
</body>
</html>